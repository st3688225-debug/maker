<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç†±è¡€å‰µå®¢ï¼šèƒ½é‡åŠ è¼‰æŒ‘æˆ°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0a0a;
            --panel-bg: #111111;
            --accent-cyan: #00ffff;
            --accent-pink: #ff0055;
            --accent-gold: #ffaa00;
            --accent-purple: #a335ee;
            --text-main: #ffffff;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Noto Sans TC', sans-serif;
            overflow: hidden; 
            height: 100vh;
            touch-action: manipulation;
        }

        .pixel-font { font-family: 'Press Start 2P', cursive; }

        .game-card {
            background: var(--panel-bg);
            border: 4px solid #444;
            box-shadow: 0 0 20px rgba(255, 0, 85, 0.2);
            position: relative;
        }

        .hp-bar {
            height: 24px;
            background: #222;
            border: 2px solid #fff;
            position: relative;
        }

        .hp-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-pink));
            width: 0%;
            transition: width 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .btn-score {
            transition: all 0.1s;
            border: 2px solid #444;
            background: #222;
            color: #fff;
        }

        .btn-score:active { transform: scale(0.9); background: var(--accent-cyan); color: #000; }
        .btn-score:hover { border-color: var(--accent-cyan); box-shadow: 0 0 15px var(--accent-cyan); }

        @keyframes shake {
            0%, 100% { transform: translate(0, 0); }
            10%, 30%, 50%, 70%, 90% { transform: translate(-4px, -4px); }
            20%, 40%, 60%, 80% { transform: translate(4px, 4px); }
        }

        .shake-effect { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-80px) scale(1.5); opacity: 0; }
        }

        .energy-popup {
            position: absolute;
            pointer-events: none;
            color: var(--accent-cyan);
            font-weight: 900;
            animation: floatUp 0.8s ease-out forwards;
            text-shadow: 0 0 10px var(--accent-cyan);
            z-index: 50;
        }

        @keyframes flash { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .press-start { animation: flash 0.8s infinite; }

        .rank-text {
            display: block;
            font-size: clamp(2.5rem, 8vw, 4.5rem);
            font-weight: 900;
            line-height: 1.2;
            margin-top: 1rem;
            animation: rankIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            letter-spacing: 0.5rem;
        }

        @keyframes rankIn {
            0% { transform: scale(8); opacity: 0; filter: blur(20px) brightness(2); }
            60% { transform: scale(0.8); opacity: 1; filter: blur(0px); }
            100% { transform: scale(1); }
        }

        .rank-unique { color: #fff; text-shadow: 0 0 20px #fff, 0 0 40px var(--accent-cyan); animation: rankIn 0.6s ease-out, flash 0.1s infinite; }
        .rank-mythic { color: var(--accent-pink); text-shadow: 0 0 20px var(--accent-pink), 0 0 40px var(--accent-pink); }
        .rank-legendary { color: var(--accent-gold); text-shadow: 0 0 25px var(--accent-gold); animation: rankIn 0.6s ease-out, shake 0.2s infinite; }
        .rank-epic { color: var(--accent-purple); text-shadow: 0 0 20px var(--accent-purple); }
        .rank-mirage { color: var(--accent-cyan); text-shadow: 0 0 20px var(--accent-cyan); }

        .scanlines {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1));
            background-size: 100% 4px; pointer-events: none; z-index: 100; opacity: 0.3;
        }
        
        .super-shake { animation: shake 0.1s infinite; }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <div class="scanlines"></div>

    <div id="game-container" class="w-full max-w-2xl relative">
        
        <div class="flex justify-between items-center mb-4 px-2">
            <div class="pixel-font text-cyan-400 text-[10px] sm:text-xs">
                ä»»å‹™é€²åº¦.<span id="stage-num">00</span>
            </div>
            <div id="loading-status" class="pixel-font text-pink-500 text-[10px] sm:text-xs press-start">
                ç­‰å¾…æ•¸æ“šä¸­...
            </div>
        </div>
        
        <div class="hp-bar mb-6 sm:mb-8 rounded-sm overflow-hidden">
            <div id="hp-fill" class="hp-fill"></div>
        </div>

        <!-- Start Screen -->
        <div id="phase-start" class="game-card p-10 text-center flex flex-col items-center justify-center min-h-[400px]">
            <h1 class="pixel-font text-2xl sm:text-4xl text-yellow-400 mb-8 leading-tight" style="text-shadow: 4px 4px #ff0055;">
                ç†±è¡€å‰µå®¢<br>èƒ½é‡åŠ è¼‰
            </h1>
            <p class="text-sm text-gray-300 mb-8 font-bold">æ­¡è¿ä¾†åˆ°æœ¬å­¸æœŸçš„æœŸæœ«å›é¥‹æŒ‘æˆ°ï¼</p>
            <button onclick="transitionTo('phase-guide')" class="pixel-font bg-cyan-400 text-black px-8 py-5 text-sm hover:bg-white shadow-[0_0_20px_#00ffff] transition-all">
                é€²å…¥èªªæ˜
            </button>
        </div>

        <!-- Guide Screen -->
        <div id="phase-guide" class="hidden game-card p-8 text-center flex flex-col justify-center min-h-[400px]">
            <div class="space-y-4">
                <h2 class="pixel-font text-xl text-cyan-400 mb-4">æŒ‘æˆ°è¦å‰‡</h2>
                <div class="text-left text-gray-300 space-y-4 font-bold text-base">
                    <p class="border-l-4 border-pink-500 pl-3">1. æ¥ä¸‹ä¾†æœ‰ 10 å€‹é—œæ–¼é€™å­¸æœŸèª²ç¨‹çš„å•é¡Œã€‚</p>
                    <p class="border-l-4 border-cyan-500 pl-3">2. è«‹ä¾ç…§ä½ çš„çœŸå¯¦æ„Ÿå—é¸æ“‡åˆ†æ•¸ï¼ˆ1åˆ†æœ€ä½ï¼Œ10åˆ†æœ€é«˜ï¼‰ã€‚</p>
                    <p class="border-l-4 border-yellow-500 pl-3">3. å®Œæˆå¾Œç³»çµ±æœƒè¨ˆç®—ä½ çš„ã€Œå‰µå®¢ç­‰ç´šã€ä¸¦çµ¦ä½ é¼“å‹µã€‚</p>
                </div>
                <div class="bg-gray-900 p-4 mt-4">
                    <p class="text-pink-400 font-bold leading-relaxed">æç¤ºï¼šè«‹å‹™å¿…èªçœŸå¡«å¯«ï¼Œä½ çš„æ„è¦‹å°è€å¸«éå¸¸é‡è¦å–”ï¼</p>
                </div>
                <button onclick="startGame()" class="mt-6 pixel-font bg-pink-500 text-white px-6 py-4 text-xs hover:bg-white hover:text-pink-500 transition-all shadow-[0_0_15px_#ff0055]">
                    é–‹å§‹æŒ‘æˆ°å§ï¼
                </button>
            </div>
        </div>

        <!-- Gameplay Phase -->
        <div id="phase-game" class="hidden game-card p-6 sm:p-10 flex flex-col justify-between min-h-[450px]">
            <div class="text-center flex-grow flex flex-col justify-center items-center">
                <span class="text-xs text-gray-500 pixel-font mb-4">ç³»çµ±åŒæ­¥ä¸­...</span>
                <h2 id="question-text" class="text-xl sm:text-2xl font-black tracking-wide leading-relaxed text-white">
                    è¼‰å…¥ä¸­...
                </h2>
                <p id="question-focus" class="mt-4 text-[10px] text-cyan-500 pixel-font opacity-70"></p>
            </div>

            <div class="space-y-2 mt-8">
                <p class="text-xs text-gray-400 font-bold text-center mb-2">è«‹é»æ“ŠæŒ‰éˆ•è©•åˆ† (1-10åˆ†)</p>
                <div class="grid grid-cols-5 gap-2 sm:gap-3">
                    <button onclick="handleScore(1, event)" class="btn-score py-4 font-black rounded text-xl">1</button>
                    <button onclick="handleScore(2, event)" class="btn-score py-4 font-black rounded text-xl">2</button>
                    <button onclick="handleScore(3, event)" class="btn-score py-4 font-black rounded text-xl">3</button>
                    <button onclick="handleScore(4, event)" class="btn-score py-4 font-black rounded text-xl">4</button>
                    <button onclick="handleScore(5, event)" class="btn-score py-4 font-black rounded text-xl">5</button>
                    <button onclick="handleScore(6, event)" class="btn-score py-4 font-black rounded text-xl">6</button>
                    <button onclick="handleScore(7, event)" class="btn-score py-4 font-black rounded text-xl">7</button>
                    <button onclick="handleScore(8, event)" class="btn-score py-4 font-black rounded text-xl">8</button>
                    <button onclick="handleScore(9, event)" class="btn-score py-4 font-black rounded text-xl">9</button>
                    <button onclick="handleScore(10, event)" class="btn-score py-4 font-black rounded text-xl">10</button>
                </div>
            </div>
        </div>

        <!-- Draw Phase -->
        <div id="phase-draw" class="hidden game-card p-10 text-center flex flex-col items-center justify-center min-h-[450px]">
            <h2 class="pixel-font text-2xl text-cyan-400 mb-4">èƒ½é‡æ»¿è¼‰ï¼ï¼</h2>
            <div class="border-2 border-pink-500 px-6 py-4 mb-8 bg-black">
                <p class="font-bold text-lg">å‰µå®¢ç¸½ç©åˆ†: <span id="final-total" class="text-pink-500 text-3xl">0</span></p>
            </div>
            <div id="omikuji-box" class="w-32 h-44 bg-gradient-to-br from-pink-600 to-red-900 border-4 border-white shadow-[0_0_40px_rgba(255,0,85,0.6)] mb-8 flex items-center justify-center">
                <span class="pixel-font text-5xl text-white">?</span>
            </div>
            <button id="draw-btn" onclick="executeDraw()" class="w-full bg-cyan-400 text-black py-5 font-black text-xl hover:bg-white shadow-[0_0_20px_#00ffff] press-start">
                é ˜å–æœ€çµ‚è©•åƒ¹
            </button>
        </div>

        <!-- Result Phase -->
        <div id="phase-result" class="hidden game-card p-6 sm:p-10 text-center flex flex-col items-center justify-center min-h-[450px]">
            <div id="result-border" class="border-4 p-6 sm:p-8 bg-black w-full relative overflow-hidden">
                <div class="pixel-font text-[10px] text-gray-500 mb-2 tracking-widest">RANKING_ANALYSIS</div>
                <div id="rank-container"></div>
                <div id="divider" class="h-1 w-full my-6 bg-white"></div>
                <p id="blessing-text" class="text-lg sm:text-xl font-bold text-white leading-relaxed mb-6"></p>
                
                <div class="bg-yellow-900/30 border border-yellow-500/50 p-3 rounded-lg">
                    <p class="text-yellow-400 font-bold text-sm sm:text-base">
                        ğŸ‰ æ–°å¹´å¿«æ¨‚ç‰¹åˆ¥ç¥ç¦ï¼š<br>
                        é¡˜ä½ çš„ 2026 å¹´ï¼Œå……æ»¿å¥½å¥‡å¿ƒèˆ‡å‰µé€ åŠ›ï¼Œæ¯å¤©éƒ½åƒé›·åˆ‡å…‰æŸä¸€æ¨£ç²¾é‡‡ï¼
                    </p>
                </div>
            </div>
            <button onclick="location.reload()" class="pixel-font text-[10px] mt-8 text-gray-600 hover:text-white transition border-b border-gray-800">é‡æ–°é–‹å§‹æ¸¬è©¦ (2026.01.01)</button>
        </div>
    </div>

    <script>
        const questions = [
            { text: "é€™å­¸æœŸçš„ Scratch ç¨‹å¼èª²ï¼Œä½ è¦ºå¾—æœ‰è¶£å—ï¼Ÿ", focus: "å­¸ç¿’èˆˆè¶£" },
            { text: "è£½ä½œé›·åˆ‡ç±¤ç­’æ™‚ï¼Œä½ æœ‰åŠªåŠ›å…‹æœå›°é›£å®Œæˆå®ƒå—ï¼Ÿ", focus: "æŒ‘æˆ°ç²¾ç¥" },
            { text: "å°æ–¼æ“ä½œç¹ªåœ–è»Ÿé«”ï¼ˆå¦‚å‘é‡åœ–è¨­è¨ˆï¼‰ï¼Œä½ æŒæ¡å¾—å¥½å—ï¼Ÿ", focus: "è»Ÿé«”æ“ä½œ" },
            { text: "çœ‹è‘—è¦ªæ‰‹åšå‡ºä¾†çš„é›·åˆ‡ç±¤ç­’ï¼Œä½ å°è‡ªå·±çš„æˆæœæ»¿æ„å—ï¼Ÿ", focus: "ä½œå“æˆå°±æ„Ÿ" },
            { text: "ç•¶ä½ åœ¨è£½ä½œéç¨‹ä¸­é‡åˆ°å•é¡Œæ™‚ï¼Œè€å¸«çš„å¹«åŠ©å°ä½ æœ‰ç”¨å—ï¼Ÿ", focus: "è€å¸«çš„å”åŠ©" },
            { text: "èˆ‡åŒå­¸è¨è«–å•é¡Œæˆ–äº’ç›¸å¹«å¿™æ™‚ï¼Œæœ‰è®“ä½ å­¸ç¿’æ›´é †åˆ©å—ï¼Ÿ", focus: "åŒå„•åˆä½œ" },
            { text: "åœ¨å‰µå®¢æ•™å®¤ä¸Šèª²çš„æ°£æ°›ï¼Œæœ‰è®“ä½ æ„Ÿåˆ°é–‹å¿ƒæƒ³å­¸ç¿’å—ï¼Ÿ", focus: "å­¸ç¿’ç’°å¢ƒ" },
            { text: "é€™é–€èª²æœ‰æ¿€ç™¼ä½ æƒ³å‹•æ‰‹åšå‡ºæ›´å¤šæ–°æ±è¥¿çš„èˆˆè¶£å—ï¼Ÿ", focus: "å‰µæ„æ¿€ç™¼" },
            { text: "é€™å­¸æœŸçš„ä¸Šèª²å…§å®¹å’Œä½œæ¥­é‡ï¼Œä½ è¦ºå¾—é©ä¸­ä¸”èƒ½æ‡‰ä»˜å—ï¼Ÿ", focus: "å­¸ç¿’å£“åŠ›" },
            { text: "å¦‚æœå­¸æ ¡é‚„æœ‰é¡ä¼¼çš„å‹•æ‰‹åšèª²ç¨‹ï¼Œä½ æœƒæƒ³æ¨è–¦çµ¦æœ‹å‹å—ï¼Ÿ", focus: "æ»¿æ„åº¦æ¨è–¦" }
        ];

        const blessings = [
            { rank: "å”¯ä¸€ç´š", class: "rank-unique", color: "#ffffff", text: "ä½ çš„å‰µæ„ç¨ä¸€ç„¡äºŒï¼Œé€™ä»½å°ˆæ³¨èˆ‡è€å¿ƒæ˜¯ä½ æœ€æ£’çš„å¯¶ç‰©ï¼" },
            { rank: "ç¥è©±ç´š", class: "rank-mythic", color: "#ff00ff", text: "ä½ å±•ç¾äº†è¶…å¼·çš„å‰µå®¢å¤©åˆ†ï¼Œæœªä¾†ä¸€å®šèƒ½åšå‡ºæ›´é©šäººçš„æ±è¥¿ï¼" },
            { rank: "å‚³èªªç´š", class: "rank-legendary", color: "#ffaa00", text: "ä½ çš„è¡¨ç¾éå¸¸å„ªç•°ï¼Œå¤§å®¶éƒ½å°ä½ çš„ä½œå“è®šä¸çµ•å£å–”ï¼" },
            { rank: "å²è©©ç´š", class: "rank-epic", color: "#a335ee", text: "ä½ åœ¨å¤±æ•—ä¸­ä¸æ–·å˜—è©¦çš„ç²¾ç¥ï¼Œè®“ä½ æˆç‚ºæœ€æ£’çš„å‰µå®¢æˆ°å£«ï¼" },
            { rank: "å¹»è±¡ç´š", class: "rank-mirage", color: "#00ffff", text: "ä½ çš„æƒ³æ³•å……æ»¿æƒ³åƒåŠ›ï¼Œé€™å­¸æœŸçš„é€²æ­¥è®“è€å¸«æ„Ÿåˆ°å¾ˆé©•å‚²ï¼" }
        ];

        let currentStage = 0;
        let totalScore = 0;

        function transitionTo(phaseId) {
            document.querySelectorAll('.game-card').forEach(p => p.classList.add('hidden'));
            document.getElementById(phaseId).classList.remove('hidden');
        }

        function startGame() {
            transitionTo('phase-game');
            document.getElementById('loading-status').innerText = "æ•¸æ“šåŒæ­¥ä¸­...";
            initStage();
        }

        function initStage() {
            if (currentStage < questions.length) {
                const stageStr = (currentStage + 1).toString().padStart(2, '0');
                document.getElementById('stage-num').innerText = stageStr;
                document.getElementById('question-text').innerText = questions[currentStage].text;
                document.getElementById('question-focus').innerText = `ç›®å‰åˆ†æï¼š${questions[currentStage].focus}`;
                document.getElementById('hp-fill').style.width = `${(currentStage / questions.length) * 100}%`;
            } else {
                showDrawPhase();
            }
        }

        function handleScore(score, e) {
            totalScore += score;
            createPopup(e.clientX, e.clientY);
            
            const card = document.getElementById('phase-game');
            card.classList.remove('shake-effect');
            void card.offsetWidth;
            card.classList.add('shake-effect');

            setTimeout(() => {
                currentStage++;
                initStage();
            }, 350);
        }

        function createPopup(x, y) {
            const p = document.createElement('div');
            p.className = 'energy-popup font-bold text-sm';
            p.innerText = `åŠ å€¼èƒ½é‡!`;
            p.style.left = `${x}px`; p.style.top = `${y - 20}px`;
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 800);
        }

        function showDrawPhase() {
            document.getElementById('hp-fill').style.width = '100%';
            document.getElementById('loading-status').innerText = "åˆ†æå®Œæˆï¼";
            document.getElementById('final-total').innerText = totalScore;
            transitionTo('phase-draw');
        }

        function executeDraw() {
            const box = document.getElementById('omikuji-box');
            document.getElementById('draw-btn').classList.add('hidden');
            box.classList.add('super-shake');
            document.body.style.animation = 'shake 0.1s infinite';

            setTimeout(() => {
                box.classList.remove('super-shake');
                document.body.style.animation = 'none';
                
                const b = blessings[Math.floor(Math.random()*blessings.length)];
                document.getElementById('rank-container').innerHTML = `<span class="rank-text ${b.class}">${b.rank}</span>`;
                document.getElementById('blessing-text').innerText = b.text;
                document.getElementById('result-border').style.borderColor = b.color;
                document.getElementById('divider').style.backgroundColor = b.color;
                
                transitionTo('phase-result');
            }, 2500);
        }
    </script>
</body>
</html>
